[rank: 0] Global seed set to 1376
[nltk_data] Downloading package punkt to /home/nlplab/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[rank: 0] Global seed set to 1376
[nltk_data] Downloading package punkt to /home/nlplab/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[rank: 0] Global seed set to 1376
[nltk_data] Downloading package wordnet to /home/nlplab/nltk_data...
[nltk_data]   Package wordnet is already up-to-date!
[nltk_data] Downloading package punkt to /home/nlplab/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package omw-1.4 to /home/nlplab/nltk_data...
[nltk_data]   Package omw-1.4 is already up-to-date!
Found cached dataset xsum (/home/nlplab/.cache/huggingface/datasets/xsum/default/1.2.0/082863bf4754ee058a5b6f6525d0cb2b18eadb62c7b370b095d1364050a52b71)

  0%|          | 0/3 [00:00<?, ?it/s]
100%|██████████| 3/3 [00:00<00:00, 853.60it/s]
['trained-models/bart-base-context-crossed-form1/checkpoint-46761', 'trained-models/bart-base-context-crossed-form1/checkpoint-29757', 'trained-models/bart-base-context-crossed-form1/checkpoint-51012']
Token indices sequence length is longer than the specified maximum sequence length for this model (1327 > 1024). Running this sequence through the model will result in indexing errors
Adding cross context enforcement
Adding cross context enforcement
Adding cross context enforcement
Some weights of BartForContextualRecovery were not initialized from the model checkpoint at facebook/bart-base and are newly initialized: ['encoder.layers.5.context_enforcer._wrc.bias', 'encoder.layers.3.context_enforcer._left_mha.out_proj.bias', 'encoder.layers.5.context_enforcer._right_mha.in_proj_weight', 'encoder.layers.1.context_enforcer_layer_norm.weight', 'encoder.layers.1.context_enforcer._left_mha.out_proj.weight', 'encoder.layers.5.context_enforcer._left_mha.in_proj_bias', 'encoder.layers.3.context_enforcer._wlc.weight', 'encoder.layers.3.context_enforcer._left_mha.in_proj_weight', 'encoder.layers.5.context_enforcer._left_mha.out_proj.weight', 'encoder.layers.1.context_enforcer._right_mha.out_proj.bias', 'encoder.layers.3.context_enforcer._wrc.weight', 'encoder.layers.1.context_enforcer._right_mha.in_proj_weight', 'encoder.layers.1.context_enforcer._context_mha.out_proj.weight', 'encoder.layers.3.context_enforcer._right_mha.out_proj.bias', 'encoder.layers.1.context_enforcer._context_mha.in_proj_bias', 'encoder.layers.3.context_enforcer._wfc.bias', 'encoder.layers.1.context_enforcer._left_mha.in_proj_bias', 'encoder.layers.3.context_enforcer._left_mha.in_proj_bias', 'encoder.layers.1.context_enforcer._wrc.bias', 'encoder.layers.5.context_enforcer._left_mha.out_proj.bias', 'encoder.layers.1.context_enforcer_layer_norm.bias', 'encoder.layers.5.context_enforcer._context_mha.out_proj.weight', 'encoder.layers.1.context_enforcer._wrc.weight', 'encoder.layers.3.context_enforcer._wlc.bias', 'encoder.layers.3.context_enforcer._wrc.bias', 'encoder.layers.3.context_enforcer._context_mha.in_proj_weight', 'encoder.layers.5.context_enforcer._wfc.weight', 'encoder.layers.5.context_enforcer._wrc.weight', 'encoder.layers.1.context_enforcer._wlc.weight', 'encoder.layers.1.context_enforcer._left_mha.in_proj_weight', 'encoder.layers.1.context_enforcer._right_mha.out_proj.weight', 'encoder.layers.5.context_enforcer._context_mha.in_proj_weight', 'encoder.layers.3.context_enforcer._context_mha.in_proj_bias', 'encoder.layers.5.context_enforcer._context_mha.in_proj_bias', 'encoder.layers.3.context_enforcer._right_mha.out_proj.weight', 'encoder.layers.5.context_enforcer_layer_norm.bias', 'encoder.layers.3.context_enforcer._wfc.weight', 'encoder.layers.1.context_enforcer._right_mha.in_proj_bias', 'encoder.layers.5.context_enforcer._wlc.bias', 'encoder.layers.5.context_enforcer._right_mha.out_proj.bias', 'encoder.layers.3.context_enforcer._context_mha.out_proj.bias', 'encoder.layers.3.context_enforcer._right_mha.in_proj_weight', 'encoder.layers.5.context_enforcer._wfc.bias', 'encoder.layers.3.context_enforcer._left_mha.out_proj.weight', 'encoder.layers.3.context_enforcer_layer_norm.weight', 'encoder.layers.5.context_enforcer._right_mha.out_proj.weight', 'encoder.layers.5.context_enforcer._wlc.weight', 'encoder.layers.3.context_enforcer_layer_norm.bias', 'encoder.layers.1.context_enforcer._context_mha.in_proj_weight', 'encoder.layers.1.context_enforcer._wfc.bias', 'encoder.layers.5.context_enforcer_layer_norm.weight', 'encoder.layers.3.context_enforcer._right_mha.in_proj_bias', 'encoder.layers.1.context_enforcer._left_mha.out_proj.bias', 'encoder.layers.1.context_enforcer._wfc.weight', 'encoder.layers.5.context_enforcer._context_mha.out_proj.bias', 'encoder.layers.1.context_enforcer._wlc.bias', 'encoder.layers.1.context_enforcer._context_mha.out_proj.bias', 'encoder.layers.3.context_enforcer._context_mha.out_proj.weight', 'encoder.layers.5.context_enforcer._right_mha.in_proj_bias', 'encoder.layers.5.context_enforcer._left_mha.in_proj_weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Performing inference using checkpoint-46761
Generating for the context length: 100
Done
{'bleu': 0.10936640835563881, 'precisions': [0.40960180179402766, 0.1554063556150339, 0.08097044012223759, 0.04594295307103814], 'brevity_penalty': 0.8816372669689411, 'length_ratio': 0.8881195251488699, 'translation_length': 231769, 'reference_length': 260966, 'meteor': 0.33022185351828504, 'rouge1': 0.37852434823643866, 'rouge2': 0.16287936582025497, 'rougeL': 0.3076886825715959, 'rougeLsum': 0.3076947635738403}
Generating for the context length: 200
Done
{'bleu': 0.12074519819936527, 'precisions': [0.43011131862725893, 0.17178419816181018, 0.09213024010664966, 0.05382245182652952], 'brevity_penalty': 0.8727451171014139, 'length_ratio': 0.8801951212035284, 'translation_length': 229701, 'reference_length': 260966, 'meteor': 0.3487952625532107, 'rouge1': 0.397204232077059, 'rouge2': 0.1786954802069412, 'rougeL': 0.3254475617899282, 'rougeLsum': 0.32541288028353943}
Generating for the context length: 300
Done
{'bleu': 0.12399799296505042, 'precisions': [0.43594787527485257, 0.177339312406577, 0.0959187931544803, 0.05598771802810682], 'brevity_penalty': 0.8686716361772506, 'length_ratio': 0.8765854555765885, 'translation_length': 228759, 'reference_length': 260966, 'meteor': 0.3538328895813539, 'rouge1': 0.40194408616928756, 'rouge2': 0.18349880266800542, 'rougeL': 0.3301652109420661, 'rougeLsum': 0.3300872695632876}
Generating for the context length: 400
Done
{'bleu': 0.12470454303875828, 'precisions': [0.43663105229321286, 0.17807922915161584, 0.09656528387989417, 0.05668606891308033], 'brevity_penalty': 0.8682123583193705, 'length_ratio': 0.8761792723956378, 'translation_length': 228653, 'reference_length': 260966, 'meteor': 0.3545260436221596, 'rouge1': 0.40319880240433126, 'rouge2': 0.1845777714865217, 'rougeL': 0.3311449695489286, 'rougeLsum': 0.3310007461471104}
Generating for the context length: 500
Done
{'bleu': 0.12348269925406297, 'precisions': [0.43659001731734587, 0.17721822652598945, 0.09585400166482498, 0.05579284157594555], 'brevity_penalty': 0.865791634330458, 'length_ratio': 0.874041062820444, 'translation_length': 228095, 'reference_length': 260966, 'meteor': 0.35348643346639935, 'rouge1': 0.4025146209671587, 'rouge2': 0.1837358303153357, 'rougeL': 0.33074240044380643, 'rougeLsum': 0.3306800163786754}
Generating for the context length: 650
Done
{'bleu': 0.12344064622072379, 'precisions': [0.43672578612485785, 0.17739617462349294, 0.09599488937546022, 0.05596993738676192], 'brevity_penalty': 0.8642097900156068, 'length_ratio': 0.8726462451047263, 'translation_length': 227731, 'reference_length': 260966, 'meteor': 0.35254781252149964, 'rouge1': 0.4016398574413643, 'rouge2': 0.18307463196415683, 'rougeL': 0.3298521416857464, 'rougeLsum': 0.32978284712403255}
Adding cross context enforcement
Adding cross context enforcement
Adding cross context enforcement
Some weights of BartForContextualRecovery were not initialized from the model checkpoint at facebook/bart-base and are newly initialized: ['encoder.layers.5.context_enforcer._wrc.bias', 'encoder.layers.3.context_enforcer._left_mha.out_proj.bias', 'encoder.layers.5.context_enforcer._right_mha.in_proj_weight', 'encoder.layers.1.context_enforcer_layer_norm.weight', 'encoder.layers.1.context_enforcer._left_mha.out_proj.weight', 'encoder.layers.5.context_enforcer._left_mha.in_proj_bias', 'encoder.layers.3.context_enforcer._wlc.weight', 'encoder.layers.3.context_enforcer._left_mha.in_proj_weight', 'encoder.layers.5.context_enforcer._left_mha.out_proj.weight', 'encoder.layers.1.context_enforcer._right_mha.out_proj.bias', 'encoder.layers.3.context_enforcer._wrc.weight', 'encoder.layers.1.context_enforcer._right_mha.in_proj_weight', 'encoder.layers.1.context_enforcer._context_mha.out_proj.weight', 'encoder.layers.3.context_enforcer._right_mha.out_proj.bias', 'encoder.layers.1.context_enforcer._context_mha.in_proj_bias', 'encoder.layers.3.context_enforcer._wfc.bias', 'encoder.layers.1.context_enforcer._left_mha.in_proj_bias', 'encoder.layers.3.context_enforcer._left_mha.in_proj_bias', 'encoder.layers.1.context_enforcer._wrc.bias', 'encoder.layers.5.context_enforcer._left_mha.out_proj.bias', 'encoder.layers.1.context_enforcer_layer_norm.bias', 'encoder.layers.5.context_enforcer._context_mha.out_proj.weight', 'encoder.layers.1.context_enforcer._wrc.weight', 'encoder.layers.3.context_enforcer._wlc.bias', 'encoder.layers.3.context_enforcer._wrc.bias', 'encoder.layers.3.context_enforcer._context_mha.in_proj_weight', 'encoder.layers.5.context_enforcer._wfc.weight', 'encoder.layers.5.context_enforcer._wrc.weight', 'encoder.layers.1.context_enforcer._wlc.weight', 'encoder.layers.1.context_enforcer._left_mha.in_proj_weight', 'encoder.layers.1.context_enforcer._right_mha.out_proj.weight', 'encoder.layers.5.context_enforcer._context_mha.in_proj_weight', 'encoder.layers.3.context_enforcer._context_mha.in_proj_bias', 'encoder.layers.5.context_enforcer._context_mha.in_proj_bias', 'encoder.layers.3.context_enforcer._right_mha.out_proj.weight', 'encoder.layers.5.context_enforcer_layer_norm.bias', 'encoder.layers.3.context_enforcer._wfc.weight', 'encoder.layers.1.context_enforcer._right_mha.in_proj_bias', 'encoder.layers.5.context_enforcer._wlc.bias', 'encoder.layers.5.context_enforcer._right_mha.out_proj.bias', 'encoder.layers.3.context_enforcer._context_mha.out_proj.bias', 'encoder.layers.3.context_enforcer._right_mha.in_proj_weight', 'encoder.layers.5.context_enforcer._wfc.bias', 'encoder.layers.3.context_enforcer._left_mha.out_proj.weight', 'encoder.layers.3.context_enforcer_layer_norm.weight', 'encoder.layers.5.context_enforcer._right_mha.out_proj.weight', 'encoder.layers.5.context_enforcer._wlc.weight', 'encoder.layers.3.context_enforcer_layer_norm.bias', 'encoder.layers.1.context_enforcer._context_mha.in_proj_weight', 'encoder.layers.1.context_enforcer._wfc.bias', 'encoder.layers.5.context_enforcer_layer_norm.weight', 'encoder.layers.3.context_enforcer._right_mha.in_proj_bias', 'encoder.layers.1.context_enforcer._left_mha.out_proj.bias', 'encoder.layers.1.context_enforcer._wfc.weight', 'encoder.layers.5.context_enforcer._context_mha.out_proj.bias', 'encoder.layers.1.context_enforcer._wlc.bias', 'encoder.layers.1.context_enforcer._context_mha.out_proj.bias', 'encoder.layers.3.context_enforcer._context_mha.out_proj.weight', 'encoder.layers.5.context_enforcer._right_mha.in_proj_bias', 'encoder.layers.5.context_enforcer._left_mha.in_proj_weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Performing inference using checkpoint-29757
Generating for the context length: 100
Done
{'bleu': 0.10155490166900775, 'precisions': [0.40352445297370243, 0.14830336560627017, 0.07543562651411226, 0.041815972651262405], 'brevity_penalty': 0.8663951205010243, 'length_ratio': 0.8745736992558417, 'translation_length': 228234, 'reference_length': 260966, 'meteor': 0.31742978638269437, 'rouge1': 0.36822156829934294, 'rouge2': 0.15479155229791952, 'rougeL': 0.29909974477565615, 'rougeLsum': 0.2991230940410639}
Generating for the context length: 200
Done
{'bleu': 0.11187987441546665, 'precisions': [0.4236727866502051, 0.16392961466966693, 0.08597581069582368, 0.04873970590533339], 'brevity_penalty': 0.8565745709362974, 'length_ratio': 0.865940390702237, 'translation_length': 225981, 'reference_length': 260966, 'meteor': 0.336041513719852, 'rouge1': 0.3872218614605963, 'rouge2': 0.16965180803311958, 'rougeL': 0.31531033531621755, 'rougeLsum': 0.315233400319532}
Generating for the context length: 300
Done
{'bleu': 0.11603989462180644, 'precisions': [0.43127417070344237, 0.17025345158892313, 0.09012455999170588, 0.05169465377394506], 'brevity_penalty': 0.8532431004616502, 'length_ratio': 0.863028133933156, 'translation_length': 225221, 'reference_length': 260966, 'meteor': 0.34252659263355417, 'rouge1': 0.3936408422736683, 'rouge2': 0.17541282705472316, 'rougeL': 0.3219027890126853, 'rougeLsum': 0.3218804848155279}
Generating for the context length: 400
Done
{'bleu': 0.11697451668860821, 'precisions': [0.43118438247295293, 0.17087304113384882, 0.09124610745885028, 0.05280768264075067], 'brevity_penalty': 0.8521759090647045, 'length_ratio': 0.8620969781504104, 'translation_length': 224978, 'reference_length': 260966, 'meteor': 0.342312122199786, 'rouge1': 0.39354519656240183, 'rouge2': 0.17619339977104112, 'rougeL': 0.3219000866879046, 'rougeLsum': 0.321868440470906}
Generating for the context length: 500
Done
{'bleu': 0.11714433765674517, 'precisions': [0.43325453815619286, 0.17189349668351528, 0.09186174593881176, 0.05303141823687752], 'brevity_penalty': 0.8487966859427654, 'length_ratio': 0.859154066046918, 'translation_length': 224210, 'reference_length': 260966, 'meteor': 0.34228428789610893, 'rouge1': 0.39420773888468763, 'rouge2': 0.1764615639966537, 'rougeL': 0.3226857343043227, 'rougeLsum': 0.3226643692410547}
Generating for the context length: 650
Done
{'bleu': 0.11721031021995489, 'precisions': [0.43293220233379914, 0.17188935340544798, 0.09161015690739, 0.052801317279859046], 'brevity_penalty': 0.8509450222575679, 'length_ratio': 0.8610240414460121, 'translation_length': 224698, 'reference_length': 260966, 'meteor': 0.34262043467495334, 'rouge1': 0.39437474361655955, 'rouge2': 0.17674925250726725, 'rougeL': 0.32317614519445415, 'rougeLsum': 0.3231516148347872}
